require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
require("angular");
var jsonpatch = require("json-patch");

var app = angular.module('fleetkeeper', []);

app.controller('IndexController', function($scope) {
    var hub = $.connection.fleetKeeperHub;
    $scope.services = [];

    hub.client.execute = function (command) {
        $scope.$apply(function () {
            var patch = new jsonpatch.JSONPatch([{
                op: command.action,
                path: command.path,
                value: command.value
            }], true);

            patch.apply($scope);
        });
    };
});
},{"angular":"uQyWva","json-patch":4}],"angular":[function(require,module,exports){
module.exports=require('uQyWva');
},{}],3:[function(require,module,exports){

},{}],4:[function(require,module,exports){
// Generated by CoffeeScript 1.6.2
(function() {
  var __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  (function(root, factory) {
    if (typeof exports !== 'undefined') {
      return factory(root, exports);
    } else if (typeof define === 'function' && define.amd) {
      return define(['exports'], function(exports) {
        return root.jsonpatch = factory(root, exports);
      });
    } else {
      return root.jsonpatch = factory(root, {});
    }
  })(this, function(root) {
    var AddPatch, CopyPatch, InvalidPatchError, InvalidPointerError, JSONPatch, JSONPatchError, JSONPointer, MovePatch, PatchConflictError, RemovePatch, ReplacePatch, TestPatch, apply, compile, hasOwnProperty, isArray, isEqual, isObject, isString, operationMap, toString, _isEqual, _ref, _ref1, _ref2, _ref3, _ref4, _ref5;

    toString = Object.prototype.toString;
    hasOwnProperty = Object.prototype.hasOwnProperty;
    isArray = function(obj) {
      return toString.call(obj) === '[object Array]';
    };
    isObject = function(obj) {
      return toString.call(obj) === '[object Object]';
    };
    isString = function(obj) {
      return toString.call(obj) === '[object String]';
    };
    _isEqual = function(a, b, stack) {
      var className, key, length, result, size;

      if (a === b) {
        return a !== 0 || 1 / a === 1 / b;
      }
      if (a === null || b === null) {
        return a === b;
      }
      className = toString.call(a);
      if (className !== toString.call(b)) {
        return false;
      }
      switch (className) {
        case '[object String]':
          String(a) === String(b);
          break;
        case '[object Number]':
          a = +a;
          b = +b;
          if (a !== a) {
            b !== b;
          } else {
            if (a === 0) {
              1 / a === 1 / b;
            } else {
              a === b;
            }
          }
          break;
        case '[object Boolean]':
          +a === +b;
      }
      if (typeof a !== 'object' || typeof b !== 'object') {
        return false;
      }
      length = stack.length;
      while (length--) {
        if (stack[length] === a) {
          return true;
        }
      }
      stack.push(a);
      size = 0;
      result = true;
      if (className === '[object Array]') {
        size = a.length;
        result = size === b.length;
        if (result) {
          while (size--) {
            if (!(result = __indexOf.call(a, size) >= 0 === __indexOf.call(b, size) >= 0 && _isEqual(a[size], b[size], stack))) {
              break;
            }
          }
        }
      } else {
        if (__indexOf.call(a, "constructor") >= 0 !== __indexOf.call(b, "constructor") >= 0 || a.constructor !== b.constructor) {
          return false;
        }
        for (key in a) {
          if (hasOwnProperty.call(a, key)) {
            size++;
            if (!(result = hasOwnProperty.call(b, key) && _isEqual(a[key], b[key], stack))) {
              break;
            }
          }
        }
        if (result) {
          for (key in b) {
            if (hasOwnProperty.call(b, key) && !size--) {
              break;
            }
          }
          result = !size;
        }
      }
      stack.pop();
      return result;
    };
    isEqual = function(a, b) {
      return _isEqual(a, b, []);
    };
    JSONPatchError = (function(_super) {
      __extends(JSONPatchError, _super);

      function JSONPatchError(message) {
        this.message = message != null ? message : 'JSON patch error';
        this.name = 'JSONPatchError';
      }

      return JSONPatchError;

    })(Error);
    InvalidPointerError = (function(_super) {
      __extends(InvalidPointerError, _super);

      function InvalidPointerError(message) {
        this.message = message != null ? message : 'Invalid pointer';
        this.name = 'InvalidPointer';
      }

      return InvalidPointerError;

    })(Error);
    InvalidPatchError = (function(_super) {
      __extends(InvalidPatchError, _super);

      function InvalidPatchError(message) {
        this.message = message != null ? message : 'Invalid patch';
        this.name = 'InvalidPatch';
      }

      return InvalidPatchError;

    })(JSONPatchError);
    PatchConflictError = (function(_super) {
      __extends(PatchConflictError, _super);

      function PatchConflictError(message) {
        this.message = message != null ? message : 'Patch conflict';
        this.name = 'PatchConflictError';
      }

      return PatchConflictError;

    })(JSONPatchError);
    JSONPointer = (function() {
      function JSONPointer(path) {
        var i, step, steps, _i, _len;

        steps = [];
        if (path && (steps = path.split('/')).shift() !== '') {
          throw new InvalidPointerError();
        }
        for (i = _i = 0, _len = steps.length; _i < _len; i = ++_i) {
          step = steps[i];
          steps[i] = step.replace('~1', '/').replace('~0', '~');
        }
        this.accessor = steps.pop();
        this.steps = steps;
        this.path = path;
      }

      JSONPointer.prototype.getReference = function(parent) {
        var step, _i, _len, _ref;

        _ref = this.steps;
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          step = _ref[_i];
          if (isArray(parent)) {
            step = parseInt(step, 10);
          }
          if (!(step in parent)) {
            throw new PatchConflictError('Array location out of ', 'bounds or not an instance property');
          }
          parent = parent[step];
        }
        return parent;
      };

      JSONPointer.prototype.coerce = function(reference, accessor) {
        if (isArray(reference)) {
          if (isString(accessor)) {
            if (accessor === '-') {
              accessor = reference.length;
            } else if (/^[-+]?\d+$/.test(accessor)) {
              accessor = parseInt(accessor, 10);
            } else {
              throw new InvalidPointerError('Invalid array index number');
            }
          }
        }
        return accessor;
      };

      return JSONPointer;

    })();
    JSONPatch = (function() {
      function JSONPatch(patch) {
        if (!('path' in patch)) {
          throw new InvalidPatchError();
        }
        this.validate(patch);
        this.patch = patch;
        this.path = new JSONPointer(patch.path);
        this.initialize(patch);
      }

      JSONPatch.prototype.initialize = function() {};

      JSONPatch.prototype.validate = function(patch) {};

      JSONPatch.prototype.apply = function(document) {
        throw new Error('Method not implemented');
      };

      return JSONPatch;

    })();
    AddPatch = (function(_super) {
      __extends(AddPatch, _super);

      function AddPatch() {
        _ref = AddPatch.__super__.constructor.apply(this, arguments);
        return _ref;
      }

      AddPatch.prototype.validate = function(patch) {
        if (!('value' in patch)) {
          throw new InvalidPatchError();
        }
      };

      AddPatch.prototype.apply = function(document) {
        var accessor, reference, value;

        reference = this.path.getReference(document);
        accessor = this.path.accessor;
        value = this.patch.value;
        if (isArray(reference)) {
          accessor = this.path.coerce(reference, accessor);
          if (accessor < 0 || accessor > reference.length) {
            throw new PatchConflictError("Index " + accessor + " out of bounds");
          }
          reference.splice(accessor, 0, value);
        } else if (accessor == null) {
          document = value;
        } else {
          reference[accessor] = value;
        }
        return document;
      };

      return AddPatch;

    })(JSONPatch);
    RemovePatch = (function(_super) {
      __extends(RemovePatch, _super);

      function RemovePatch() {
        _ref1 = RemovePatch.__super__.constructor.apply(this, arguments);
        return _ref1;
      }

      RemovePatch.prototype.apply = function(document) {
        var accessor, reference;

        reference = this.path.getReference(document);
        accessor = this.path.accessor;
        if (isArray(reference)) {
          accessor = this.path.coerce(reference, accessor);
          if (!(accessor in reference)) {
            throw new PatchConflictError("Value at " + accessor + " does not exist");
          }
          reference.splice(accessor, 1);
        } else {
          if (!(accessor in reference)) {
            throw new PatchConflictError("Value at " + accessor + " does not exist");
          }
          delete reference[accessor];
        }
        return document;
      };

      return RemovePatch;

    })(JSONPatch);
    ReplacePatch = (function(_super) {
      __extends(ReplacePatch, _super);

      function ReplacePatch() {
        _ref2 = ReplacePatch.__super__.constructor.apply(this, arguments);
        return _ref2;
      }

      ReplacePatch.prototype.validate = function(patch) {
        if (!('value' in patch)) {
          throw new InvalidPatchError();
        }
      };

      ReplacePatch.prototype.apply = function(document) {
        var accessor, reference, value;

        reference = this.path.getReference(document);
        accessor = this.path.accessor;
        value = this.patch.value;
        if (isArray(reference)) {
          accessor = this.path.coerce(reference, accessor);
          if (!(accessor in reference)) {
            throw new PatchConflictError("Value at " + accessor + " does not exist");
          }
          reference.splice(accessor, 1, value);
        } else {
          if (!(accessor in reference)) {
            throw new PatchConflictError("Value at " + accessor + " does not exist");
          }
          reference[accessor] = value;
        }
        return document;
      };

      return ReplacePatch;

    })(JSONPatch);
    TestPatch = (function(_super) {
      __extends(TestPatch, _super);

      function TestPatch() {
        _ref3 = TestPatch.__super__.constructor.apply(this, arguments);
        return _ref3;
      }

      TestPatch.prototype.validate = function(patch) {
        if (!('value' in patch)) {
          throw new InvalidPatchError();
        }
      };

      TestPatch.prototype.apply = function(document) {
        var accessor, reference, value;

        reference = this.path.getReference(document);
        accessor = this.path.accessor;
        value = this.patch.value;
        if (isArray(reference)) {
          accessor = this.path.coerce(reference, accessor);
        }
        return isEqual(reference[accessor], value);
      };

      return TestPatch;

    })(JSONPatch);
    MovePatch = (function(_super) {
      __extends(MovePatch, _super);

      function MovePatch() {
        _ref4 = MovePatch.__super__.constructor.apply(this, arguments);
        return _ref4;
      }

      MovePatch.prototype.initialize = function(patch) {
        var i, len, within, _i;

        this.from = new JSONPointer(patch.from);
        len = this.from.steps.length;
        within = true;
        for (i = _i = 0; 0 <= len ? _i <= len : _i >= len; i = 0 <= len ? ++_i : --_i) {
          if (this.from.steps[i] !== this.path.steps[i]) {
            within = false;
            break;
          }
        }
        if (within) {
          if (this.path.steps.length !== len) {
            throw new InvalidPatchError("'to' member cannot be a descendent of 'path'");
          }
          if (this.from.accessor === this.path.accessor) {
            return this.apply = function(document) {
              return document;
            };
          }
        }
      };

      MovePatch.prototype.validate = function(patch) {
        if (!('from' in patch)) {
          throw new InvalidPatchError();
        }
      };

      MovePatch.prototype.apply = function(document) {
        var accessor, reference, value;

        reference = this.from.getReference(document);
        accessor = this.from.accessor;
        if (isArray(reference)) {
          accessor = this.from.coerce(reference, accessor);
          if (!(accessor in reference)) {
            throw new PatchConflictError("Value at " + accessor + " does not exist");
          }
          value = reference.splice(accessor, 1)[0];
        } else {
          if (!(accessor in reference)) {
            throw new PatchConflictError("Value at " + accessor + " does not exist");
          }
          value = reference[accessor];
          delete reference[accessor];
        }
        reference = this.path.getReference(document);
        accessor = this.path.accessor;
        if (isArray(reference)) {
          accessor = this.path.coerce(reference, accessor);
          if (accessor < 0 || accessor > reference.length) {
            throw new PatchConflictError("Index " + accessor + " out of bounds");
          }
          reference.splice(accessor, 0, value);
        } else {
          if (accessor in reference) {
            throw new PatchConflictError("Value at " + accessor + " exists");
          }
          reference[accessor] = value;
        }
        return document;
      };

      return MovePatch;

    })(JSONPatch);
    CopyPatch = (function(_super) {
      __extends(CopyPatch, _super);

      function CopyPatch() {
        _ref5 = CopyPatch.__super__.constructor.apply(this, arguments);
        return _ref5;
      }

      CopyPatch.prototype.apply = function(document) {
        var accessor, reference, value;

        reference = this.from.getReference(document);
        accessor = this.from.accessor;
        if (isArray(reference)) {
          accessor = this.from.coerce(reference, accessor);
          if (!(accessor in reference)) {
            throw new PatchConflictError("Value at " + accessor + " does not exist");
          }
          value = reference.slice(accessor, accessor + 1)[0];
        } else {
          if (!(accessor in reference)) {
            throw new PatchConflictError("Value at " + accessor + " does not exist");
          }
          value = reference[accessor];
        }
        reference = this.path.getReference(document);
        accessor = this.path.accessor;
        if (isArray(reference)) {
          accessor = this.path.coerce(reference, accessor);
          if (accessor < 0 || accessor > reference.length) {
            throw new PatchConflictError("Index " + accessor + " out of bounds");
          }
          reference.splice(accessor, 0, value);
        } else {
          if (accessor in reference) {
            throw new PatchConflictError("Value at " + accessor + " exists");
          }
          reference[accessor] = value;
        }
        return document;
      };

      return CopyPatch;

    })(MovePatch);
    operationMap = {
      add: AddPatch,
      remove: RemovePatch,
      replace: ReplacePatch,
      move: MovePatch,
      copy: CopyPatch,
      test: TestPatch
    };
    compile = function(patch) {
      var klass, ops, p, _i, _len;

      ops = [];
      for (_i = 0, _len = patch.length; _i < _len; _i++) {
        p = patch[_i];
        if (!(klass = operationMap[p.op])) {
          throw new InvalidPatchError();
        }
        ops.push(new klass(p));
      }
      return function(document) {
        var op, result, _j, _len1;

        result = document;
        for (_j = 0, _len1 = ops.length; _j < _len1; _j++) {
          op = ops[_j];
          result = op.apply(document);
        }
        return result;
      };
    };
    apply = function(document, patch) {
      return compile(patch)(document);
    };
    root.apply = apply;
    root.compile = compile;
    root.JSONPointer = JSONPointer;
    root.JSONPatch = JSONPatch;
    root.JSONPatchError = JSONPatchError;
    root.InvalidPointerError = InvalidPointerError;
    root.InvalidPatchError = InvalidPatchError;
    root.PatchConflictError = PatchConflictError;
    return root;
  });

}).call(this);

},{}]},{},[1])
//@ sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyJjOlxcd29ya3NwYWNlXFxSZWJ1c1xcc3JjXFxSZWJ1cy5GbGVldEtlZXBlclxcV2ViXFxqc1xcYXBwLmpzIiwiYzpcXHdvcmtzcGFjZVxcUmVidXNcXHNyY1xcUmVidXMuRmxlZXRLZWVwZXJcXFdlYlxcbm9kZV9tb2R1bGVzXFxncnVudC1icm93c2VyaWZ5XFxub2RlX21vZHVsZXNcXGJyb3dzZXJpZnlcXF9lbXB0eS5qcyIsImM6XFx3b3Jrc3BhY2VcXFJlYnVzXFxzcmNcXFJlYnVzLkZsZWV0S2VlcGVyXFxXZWJcXG5vZGVfbW9kdWxlc1xcanNvbi1wYXRjaFxcanNvbnBhdGNoLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNwQkE7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKFwiYW5ndWxhclwiKTtcclxudmFyIGpzb25wYXRjaCA9IHJlcXVpcmUoXCJqc29uLXBhdGNoXCIpO1xyXG5cclxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdmbGVldGtlZXBlcicsIFtdKTtcclxuXHJcbmFwcC5jb250cm9sbGVyKCdJbmRleENvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUpIHtcclxuICAgIHZhciBodWIgPSAkLmNvbm5lY3Rpb24uZmxlZXRLZWVwZXJIdWI7XHJcbiAgICAkc2NvcGUuc2VydmljZXMgPSBbXTtcclxuXHJcbiAgICBodWIuY2xpZW50LmV4ZWN1dGUgPSBmdW5jdGlvbiAoY29tbWFuZCkge1xyXG4gICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcGF0Y2ggPSBuZXcganNvbnBhdGNoLkpTT05QYXRjaChbe1xyXG4gICAgICAgICAgICAgICAgb3A6IGNvbW1hbmQuYWN0aW9uLFxyXG4gICAgICAgICAgICAgICAgcGF0aDogY29tbWFuZC5wYXRoLFxyXG4gICAgICAgICAgICAgICAgdmFsdWU6IGNvbW1hbmQudmFsdWVcclxuICAgICAgICAgICAgfV0sIHRydWUpO1xyXG5cclxuICAgICAgICAgICAgcGF0Y2guYXBwbHkoJHNjb3BlKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbn0pOyIsbnVsbCwiLy8gR2VuZXJhdGVkIGJ5IENvZmZlZVNjcmlwdCAxLjYuMlxuKGZ1bmN0aW9uKCkge1xuICB2YXIgX19pbmRleE9mID0gW10uaW5kZXhPZiB8fCBmdW5jdGlvbihpdGVtKSB7IGZvciAodmFyIGkgPSAwLCBsID0gdGhpcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsgaWYgKGkgaW4gdGhpcyAmJiB0aGlzW2ldID09PSBpdGVtKSByZXR1cm4gaTsgfSByZXR1cm4gLTE7IH0sXG4gICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksXG4gICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07XG5cbiAgKGZ1bmN0aW9uKHJvb3QsIGZhY3RvcnkpIHtcbiAgICBpZiAodHlwZW9mIGV4cG9ydHMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICByZXR1cm4gZmFjdG9yeShyb290LCBleHBvcnRzKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgICAgcmV0dXJuIGRlZmluZShbJ2V4cG9ydHMnXSwgZnVuY3Rpb24oZXhwb3J0cykge1xuICAgICAgICByZXR1cm4gcm9vdC5qc29ucGF0Y2ggPSBmYWN0b3J5KHJvb3QsIGV4cG9ydHMpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiByb290Lmpzb25wYXRjaCA9IGZhY3Rvcnkocm9vdCwge30pO1xuICAgIH1cbiAgfSkodGhpcywgZnVuY3Rpb24ocm9vdCkge1xuICAgIHZhciBBZGRQYXRjaCwgQ29weVBhdGNoLCBJbnZhbGlkUGF0Y2hFcnJvciwgSW52YWxpZFBvaW50ZXJFcnJvciwgSlNPTlBhdGNoLCBKU09OUGF0Y2hFcnJvciwgSlNPTlBvaW50ZXIsIE1vdmVQYXRjaCwgUGF0Y2hDb25mbGljdEVycm9yLCBSZW1vdmVQYXRjaCwgUmVwbGFjZVBhdGNoLCBUZXN0UGF0Y2gsIGFwcGx5LCBjb21waWxlLCBoYXNPd25Qcm9wZXJ0eSwgaXNBcnJheSwgaXNFcXVhbCwgaXNPYmplY3QsIGlzU3RyaW5nLCBvcGVyYXRpb25NYXAsIHRvU3RyaW5nLCBfaXNFcXVhbCwgX3JlZiwgX3JlZjEsIF9yZWYyLCBfcmVmMywgX3JlZjQsIF9yZWY1O1xuXG4gICAgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuICAgIGhhc093blByb3BlcnR5ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcbiAgICBpc0FycmF5ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopID09PSAnW29iamVjdCBBcnJheV0nO1xuICAgIH07XG4gICAgaXNPYmplY3QgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IE9iamVjdF0nO1xuICAgIH07XG4gICAgaXNTdHJpbmcgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IFN0cmluZ10nO1xuICAgIH07XG4gICAgX2lzRXF1YWwgPSBmdW5jdGlvbihhLCBiLCBzdGFjaykge1xuICAgICAgdmFyIGNsYXNzTmFtZSwga2V5LCBsZW5ndGgsIHJlc3VsdCwgc2l6ZTtcblxuICAgICAgaWYgKGEgPT09IGIpIHtcbiAgICAgICAgcmV0dXJuIGEgIT09IDAgfHwgMSAvIGEgPT09IDEgLyBiO1xuICAgICAgfVxuICAgICAgaWYgKGEgPT09IG51bGwgfHwgYiA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gYSA9PT0gYjtcbiAgICAgIH1cbiAgICAgIGNsYXNzTmFtZSA9IHRvU3RyaW5nLmNhbGwoYSk7XG4gICAgICBpZiAoY2xhc3NOYW1lICE9PSB0b1N0cmluZy5jYWxsKGIpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHN3aXRjaCAoY2xhc3NOYW1lKSB7XG4gICAgICAgIGNhc2UgJ1tvYmplY3QgU3RyaW5nXSc6XG4gICAgICAgICAgU3RyaW5nKGEpID09PSBTdHJpbmcoYik7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ1tvYmplY3QgTnVtYmVyXSc6XG4gICAgICAgICAgYSA9ICthO1xuICAgICAgICAgIGIgPSArYjtcbiAgICAgICAgICBpZiAoYSAhPT0gYSkge1xuICAgICAgICAgICAgYiAhPT0gYjtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGEgPT09IDApIHtcbiAgICAgICAgICAgICAgMSAvIGEgPT09IDEgLyBiO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgYSA9PT0gYjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ1tvYmplY3QgQm9vbGVhbl0nOlxuICAgICAgICAgICthID09PSArYjtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgYSAhPT0gJ29iamVjdCcgfHwgdHlwZW9mIGIgIT09ICdvYmplY3QnKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGxlbmd0aCA9IHN0YWNrLmxlbmd0aDtcbiAgICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgICBpZiAoc3RhY2tbbGVuZ3RoXSA9PT0gYSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBzdGFjay5wdXNoKGEpO1xuICAgICAgc2l6ZSA9IDA7XG4gICAgICByZXN1bHQgPSB0cnVlO1xuICAgICAgaWYgKGNsYXNzTmFtZSA9PT0gJ1tvYmplY3QgQXJyYXldJykge1xuICAgICAgICBzaXplID0gYS5sZW5ndGg7XG4gICAgICAgIHJlc3VsdCA9IHNpemUgPT09IGIubGVuZ3RoO1xuICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgd2hpbGUgKHNpemUtLSkge1xuICAgICAgICAgICAgaWYgKCEocmVzdWx0ID0gX19pbmRleE9mLmNhbGwoYSwgc2l6ZSkgPj0gMCA9PT0gX19pbmRleE9mLmNhbGwoYiwgc2l6ZSkgPj0gMCAmJiBfaXNFcXVhbChhW3NpemVdLCBiW3NpemVdLCBzdGFjaykpKSB7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKF9faW5kZXhPZi5jYWxsKGEsIFwiY29uc3RydWN0b3JcIikgPj0gMCAhPT0gX19pbmRleE9mLmNhbGwoYiwgXCJjb25zdHJ1Y3RvclwiKSA+PSAwIHx8IGEuY29uc3RydWN0b3IgIT09IGIuY29uc3RydWN0b3IpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChrZXkgaW4gYSkge1xuICAgICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKGEsIGtleSkpIHtcbiAgICAgICAgICAgIHNpemUrKztcbiAgICAgICAgICAgIGlmICghKHJlc3VsdCA9IGhhc093blByb3BlcnR5LmNhbGwoYiwga2V5KSAmJiBfaXNFcXVhbChhW2tleV0sIGJba2V5XSwgc3RhY2spKSkge1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgIGZvciAoa2V5IGluIGIpIHtcbiAgICAgICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIGtleSkgJiYgIXNpemUtLSkge1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmVzdWx0ID0gIXNpemU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHN0YWNrLnBvcCgpO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIGlzRXF1YWwgPSBmdW5jdGlvbihhLCBiKSB7XG4gICAgICByZXR1cm4gX2lzRXF1YWwoYSwgYiwgW10pO1xuICAgIH07XG4gICAgSlNPTlBhdGNoRXJyb3IgPSAoZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoSlNPTlBhdGNoRXJyb3IsIF9zdXBlcik7XG5cbiAgICAgIGZ1bmN0aW9uIEpTT05QYXRjaEVycm9yKG1lc3NhZ2UpIHtcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZSAhPSBudWxsID8gbWVzc2FnZSA6ICdKU09OIHBhdGNoIGVycm9yJztcbiAgICAgICAgdGhpcy5uYW1lID0gJ0pTT05QYXRjaEVycm9yJztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIEpTT05QYXRjaEVycm9yO1xuXG4gICAgfSkoRXJyb3IpO1xuICAgIEludmFsaWRQb2ludGVyRXJyb3IgPSAoZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoSW52YWxpZFBvaW50ZXJFcnJvciwgX3N1cGVyKTtcblxuICAgICAgZnVuY3Rpb24gSW52YWxpZFBvaW50ZXJFcnJvcihtZXNzYWdlKSB7XG4gICAgICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2UgIT0gbnVsbCA/IG1lc3NhZ2UgOiAnSW52YWxpZCBwb2ludGVyJztcbiAgICAgICAgdGhpcy5uYW1lID0gJ0ludmFsaWRQb2ludGVyJztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIEludmFsaWRQb2ludGVyRXJyb3I7XG5cbiAgICB9KShFcnJvcik7XG4gICAgSW52YWxpZFBhdGNoRXJyb3IgPSAoZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoSW52YWxpZFBhdGNoRXJyb3IsIF9zdXBlcik7XG5cbiAgICAgIGZ1bmN0aW9uIEludmFsaWRQYXRjaEVycm9yKG1lc3NhZ2UpIHtcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZSAhPSBudWxsID8gbWVzc2FnZSA6ICdJbnZhbGlkIHBhdGNoJztcbiAgICAgICAgdGhpcy5uYW1lID0gJ0ludmFsaWRQYXRjaCc7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBJbnZhbGlkUGF0Y2hFcnJvcjtcblxuICAgIH0pKEpTT05QYXRjaEVycm9yKTtcbiAgICBQYXRjaENvbmZsaWN0RXJyb3IgPSAoZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoUGF0Y2hDb25mbGljdEVycm9yLCBfc3VwZXIpO1xuXG4gICAgICBmdW5jdGlvbiBQYXRjaENvbmZsaWN0RXJyb3IobWVzc2FnZSkge1xuICAgICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlICE9IG51bGwgPyBtZXNzYWdlIDogJ1BhdGNoIGNvbmZsaWN0JztcbiAgICAgICAgdGhpcy5uYW1lID0gJ1BhdGNoQ29uZmxpY3RFcnJvcic7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBQYXRjaENvbmZsaWN0RXJyb3I7XG5cbiAgICB9KShKU09OUGF0Y2hFcnJvcik7XG4gICAgSlNPTlBvaW50ZXIgPSAoZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBKU09OUG9pbnRlcihwYXRoKSB7XG4gICAgICAgIHZhciBpLCBzdGVwLCBzdGVwcywgX2ksIF9sZW47XG5cbiAgICAgICAgc3RlcHMgPSBbXTtcbiAgICAgICAgaWYgKHBhdGggJiYgKHN0ZXBzID0gcGF0aC5zcGxpdCgnLycpKS5zaGlmdCgpICE9PSAnJykge1xuICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkUG9pbnRlckVycm9yKCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChpID0gX2kgPSAwLCBfbGVuID0gc3RlcHMubGVuZ3RoOyBfaSA8IF9sZW47IGkgPSArK19pKSB7XG4gICAgICAgICAgc3RlcCA9IHN0ZXBzW2ldO1xuICAgICAgICAgIHN0ZXBzW2ldID0gc3RlcC5yZXBsYWNlKCd+MScsICcvJykucmVwbGFjZSgnfjAnLCAnficpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYWNjZXNzb3IgPSBzdGVwcy5wb3AoKTtcbiAgICAgICAgdGhpcy5zdGVwcyA9IHN0ZXBzO1xuICAgICAgICB0aGlzLnBhdGggPSBwYXRoO1xuICAgICAgfVxuXG4gICAgICBKU09OUG9pbnRlci5wcm90b3R5cGUuZ2V0UmVmZXJlbmNlID0gZnVuY3Rpb24ocGFyZW50KSB7XG4gICAgICAgIHZhciBzdGVwLCBfaSwgX2xlbiwgX3JlZjtcblxuICAgICAgICBfcmVmID0gdGhpcy5zdGVwcztcbiAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XG4gICAgICAgICAgc3RlcCA9IF9yZWZbX2ldO1xuICAgICAgICAgIGlmIChpc0FycmF5KHBhcmVudCkpIHtcbiAgICAgICAgICAgIHN0ZXAgPSBwYXJzZUludChzdGVwLCAxMCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghKHN0ZXAgaW4gcGFyZW50KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFBhdGNoQ29uZmxpY3RFcnJvcignQXJyYXkgbG9jYXRpb24gb3V0IG9mICcsICdib3VuZHMgb3Igbm90IGFuIGluc3RhbmNlIHByb3BlcnR5Jyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHBhcmVudCA9IHBhcmVudFtzdGVwXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFyZW50O1xuICAgICAgfTtcblxuICAgICAgSlNPTlBvaW50ZXIucHJvdG90eXBlLmNvZXJjZSA9IGZ1bmN0aW9uKHJlZmVyZW5jZSwgYWNjZXNzb3IpIHtcbiAgICAgICAgaWYgKGlzQXJyYXkocmVmZXJlbmNlKSkge1xuICAgICAgICAgIGlmIChpc1N0cmluZyhhY2Nlc3NvcikpIHtcbiAgICAgICAgICAgIGlmIChhY2Nlc3NvciA9PT0gJy0nKSB7XG4gICAgICAgICAgICAgIGFjY2Vzc29yID0gcmVmZXJlbmNlLmxlbmd0aDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoL15bLStdP1xcZCskLy50ZXN0KGFjY2Vzc29yKSkge1xuICAgICAgICAgICAgICBhY2Nlc3NvciA9IHBhcnNlSW50KGFjY2Vzc29yLCAxMCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFBvaW50ZXJFcnJvcignSW52YWxpZCBhcnJheSBpbmRleCBudW1iZXInKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFjY2Vzc29yO1xuICAgICAgfTtcblxuICAgICAgcmV0dXJuIEpTT05Qb2ludGVyO1xuXG4gICAgfSkoKTtcbiAgICBKU09OUGF0Y2ggPSAoZnVuY3Rpb24oKSB7XG4gICAgICBmdW5jdGlvbiBKU09OUGF0Y2gocGF0Y2gpIHtcbiAgICAgICAgaWYgKCEoJ3BhdGgnIGluIHBhdGNoKSkge1xuICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkUGF0Y2hFcnJvcigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudmFsaWRhdGUocGF0Y2gpO1xuICAgICAgICB0aGlzLnBhdGNoID0gcGF0Y2g7XG4gICAgICAgIHRoaXMucGF0aCA9IG5ldyBKU09OUG9pbnRlcihwYXRjaC5wYXRoKTtcbiAgICAgICAgdGhpcy5pbml0aWFsaXplKHBhdGNoKTtcbiAgICAgIH1cblxuICAgICAgSlNPTlBhdGNoLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24oKSB7fTtcblxuICAgICAgSlNPTlBhdGNoLnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uKHBhdGNoKSB7fTtcblxuICAgICAgSlNPTlBhdGNoLnByb3RvdHlwZS5hcHBseSA9IGZ1bmN0aW9uKGRvY3VtZW50KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWV0aG9kIG5vdCBpbXBsZW1lbnRlZCcpO1xuICAgICAgfTtcblxuICAgICAgcmV0dXJuIEpTT05QYXRjaDtcblxuICAgIH0pKCk7XG4gICAgQWRkUGF0Y2ggPSAoZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoQWRkUGF0Y2gsIF9zdXBlcik7XG5cbiAgICAgIGZ1bmN0aW9uIEFkZFBhdGNoKCkge1xuICAgICAgICBfcmVmID0gQWRkUGF0Y2guX19zdXBlcl9fLmNvbnN0cnVjdG9yLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIHJldHVybiBfcmVmO1xuICAgICAgfVxuXG4gICAgICBBZGRQYXRjaC5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbihwYXRjaCkge1xuICAgICAgICBpZiAoISgndmFsdWUnIGluIHBhdGNoKSkge1xuICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkUGF0Y2hFcnJvcigpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBBZGRQYXRjaC5wcm90b3R5cGUuYXBwbHkgPSBmdW5jdGlvbihkb2N1bWVudCkge1xuICAgICAgICB2YXIgYWNjZXNzb3IsIHJlZmVyZW5jZSwgdmFsdWU7XG5cbiAgICAgICAgcmVmZXJlbmNlID0gdGhpcy5wYXRoLmdldFJlZmVyZW5jZShkb2N1bWVudCk7XG4gICAgICAgIGFjY2Vzc29yID0gdGhpcy5wYXRoLmFjY2Vzc29yO1xuICAgICAgICB2YWx1ZSA9IHRoaXMucGF0Y2gudmFsdWU7XG4gICAgICAgIGlmIChpc0FycmF5KHJlZmVyZW5jZSkpIHtcbiAgICAgICAgICBhY2Nlc3NvciA9IHRoaXMucGF0aC5jb2VyY2UocmVmZXJlbmNlLCBhY2Nlc3Nvcik7XG4gICAgICAgICAgaWYgKGFjY2Vzc29yIDwgMCB8fCBhY2Nlc3NvciA+IHJlZmVyZW5jZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBQYXRjaENvbmZsaWN0RXJyb3IoXCJJbmRleCBcIiArIGFjY2Vzc29yICsgXCIgb3V0IG9mIGJvdW5kc1wiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmVmZXJlbmNlLnNwbGljZShhY2Nlc3NvciwgMCwgdmFsdWUpO1xuICAgICAgICB9IGVsc2UgaWYgKGFjY2Vzc29yID09IG51bGwpIHtcbiAgICAgICAgICBkb2N1bWVudCA9IHZhbHVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlZmVyZW5jZVthY2Nlc3Nvcl0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZG9jdW1lbnQ7XG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gQWRkUGF0Y2g7XG5cbiAgICB9KShKU09OUGF0Y2gpO1xuICAgIFJlbW92ZVBhdGNoID0gKGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKFJlbW92ZVBhdGNoLCBfc3VwZXIpO1xuXG4gICAgICBmdW5jdGlvbiBSZW1vdmVQYXRjaCgpIHtcbiAgICAgICAgX3JlZjEgPSBSZW1vdmVQYXRjaC5fX3N1cGVyX18uY29uc3RydWN0b3IuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgcmV0dXJuIF9yZWYxO1xuICAgICAgfVxuXG4gICAgICBSZW1vdmVQYXRjaC5wcm90b3R5cGUuYXBwbHkgPSBmdW5jdGlvbihkb2N1bWVudCkge1xuICAgICAgICB2YXIgYWNjZXNzb3IsIHJlZmVyZW5jZTtcblxuICAgICAgICByZWZlcmVuY2UgPSB0aGlzLnBhdGguZ2V0UmVmZXJlbmNlKGRvY3VtZW50KTtcbiAgICAgICAgYWNjZXNzb3IgPSB0aGlzLnBhdGguYWNjZXNzb3I7XG4gICAgICAgIGlmIChpc0FycmF5KHJlZmVyZW5jZSkpIHtcbiAgICAgICAgICBhY2Nlc3NvciA9IHRoaXMucGF0aC5jb2VyY2UocmVmZXJlbmNlLCBhY2Nlc3Nvcik7XG4gICAgICAgICAgaWYgKCEoYWNjZXNzb3IgaW4gcmVmZXJlbmNlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFBhdGNoQ29uZmxpY3RFcnJvcihcIlZhbHVlIGF0IFwiICsgYWNjZXNzb3IgKyBcIiBkb2VzIG5vdCBleGlzdFwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmVmZXJlbmNlLnNwbGljZShhY2Nlc3NvciwgMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKCEoYWNjZXNzb3IgaW4gcmVmZXJlbmNlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFBhdGNoQ29uZmxpY3RFcnJvcihcIlZhbHVlIGF0IFwiICsgYWNjZXNzb3IgKyBcIiBkb2VzIG5vdCBleGlzdFwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZGVsZXRlIHJlZmVyZW5jZVthY2Nlc3Nvcl07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRvY3VtZW50O1xuICAgICAgfTtcblxuICAgICAgcmV0dXJuIFJlbW92ZVBhdGNoO1xuXG4gICAgfSkoSlNPTlBhdGNoKTtcbiAgICBSZXBsYWNlUGF0Y2ggPSAoZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoUmVwbGFjZVBhdGNoLCBfc3VwZXIpO1xuXG4gICAgICBmdW5jdGlvbiBSZXBsYWNlUGF0Y2goKSB7XG4gICAgICAgIF9yZWYyID0gUmVwbGFjZVBhdGNoLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICByZXR1cm4gX3JlZjI7XG4gICAgICB9XG5cbiAgICAgIFJlcGxhY2VQYXRjaC5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbihwYXRjaCkge1xuICAgICAgICBpZiAoISgndmFsdWUnIGluIHBhdGNoKSkge1xuICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkUGF0Y2hFcnJvcigpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBSZXBsYWNlUGF0Y2gucHJvdG90eXBlLmFwcGx5ID0gZnVuY3Rpb24oZG9jdW1lbnQpIHtcbiAgICAgICAgdmFyIGFjY2Vzc29yLCByZWZlcmVuY2UsIHZhbHVlO1xuXG4gICAgICAgIHJlZmVyZW5jZSA9IHRoaXMucGF0aC5nZXRSZWZlcmVuY2UoZG9jdW1lbnQpO1xuICAgICAgICBhY2Nlc3NvciA9IHRoaXMucGF0aC5hY2Nlc3NvcjtcbiAgICAgICAgdmFsdWUgPSB0aGlzLnBhdGNoLnZhbHVlO1xuICAgICAgICBpZiAoaXNBcnJheShyZWZlcmVuY2UpKSB7XG4gICAgICAgICAgYWNjZXNzb3IgPSB0aGlzLnBhdGguY29lcmNlKHJlZmVyZW5jZSwgYWNjZXNzb3IpO1xuICAgICAgICAgIGlmICghKGFjY2Vzc29yIGluIHJlZmVyZW5jZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBQYXRjaENvbmZsaWN0RXJyb3IoXCJWYWx1ZSBhdCBcIiArIGFjY2Vzc29yICsgXCIgZG9lcyBub3QgZXhpc3RcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJlZmVyZW5jZS5zcGxpY2UoYWNjZXNzb3IsIDEsIHZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoIShhY2Nlc3NvciBpbiByZWZlcmVuY2UpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgUGF0Y2hDb25mbGljdEVycm9yKFwiVmFsdWUgYXQgXCIgKyBhY2Nlc3NvciArIFwiIGRvZXMgbm90IGV4aXN0XCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZWZlcmVuY2VbYWNjZXNzb3JdID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRvY3VtZW50O1xuICAgICAgfTtcblxuICAgICAgcmV0dXJuIFJlcGxhY2VQYXRjaDtcblxuICAgIH0pKEpTT05QYXRjaCk7XG4gICAgVGVzdFBhdGNoID0gKGZ1bmN0aW9uKF9zdXBlcikge1xuICAgICAgX19leHRlbmRzKFRlc3RQYXRjaCwgX3N1cGVyKTtcblxuICAgICAgZnVuY3Rpb24gVGVzdFBhdGNoKCkge1xuICAgICAgICBfcmVmMyA9IFRlc3RQYXRjaC5fX3N1cGVyX18uY29uc3RydWN0b3IuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgcmV0dXJuIF9yZWYzO1xuICAgICAgfVxuXG4gICAgICBUZXN0UGF0Y2gucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24ocGF0Y2gpIHtcbiAgICAgICAgaWYgKCEoJ3ZhbHVlJyBpbiBwYXRjaCkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFBhdGNoRXJyb3IoKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgVGVzdFBhdGNoLnByb3RvdHlwZS5hcHBseSA9IGZ1bmN0aW9uKGRvY3VtZW50KSB7XG4gICAgICAgIHZhciBhY2Nlc3NvciwgcmVmZXJlbmNlLCB2YWx1ZTtcblxuICAgICAgICByZWZlcmVuY2UgPSB0aGlzLnBhdGguZ2V0UmVmZXJlbmNlKGRvY3VtZW50KTtcbiAgICAgICAgYWNjZXNzb3IgPSB0aGlzLnBhdGguYWNjZXNzb3I7XG4gICAgICAgIHZhbHVlID0gdGhpcy5wYXRjaC52YWx1ZTtcbiAgICAgICAgaWYgKGlzQXJyYXkocmVmZXJlbmNlKSkge1xuICAgICAgICAgIGFjY2Vzc29yID0gdGhpcy5wYXRoLmNvZXJjZShyZWZlcmVuY2UsIGFjY2Vzc29yKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNFcXVhbChyZWZlcmVuY2VbYWNjZXNzb3JdLCB2YWx1ZSk7XG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gVGVzdFBhdGNoO1xuXG4gICAgfSkoSlNPTlBhdGNoKTtcbiAgICBNb3ZlUGF0Y2ggPSAoZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoTW92ZVBhdGNoLCBfc3VwZXIpO1xuXG4gICAgICBmdW5jdGlvbiBNb3ZlUGF0Y2goKSB7XG4gICAgICAgIF9yZWY0ID0gTW92ZVBhdGNoLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICByZXR1cm4gX3JlZjQ7XG4gICAgICB9XG5cbiAgICAgIE1vdmVQYXRjaC5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKHBhdGNoKSB7XG4gICAgICAgIHZhciBpLCBsZW4sIHdpdGhpbiwgX2k7XG5cbiAgICAgICAgdGhpcy5mcm9tID0gbmV3IEpTT05Qb2ludGVyKHBhdGNoLmZyb20pO1xuICAgICAgICBsZW4gPSB0aGlzLmZyb20uc3RlcHMubGVuZ3RoO1xuICAgICAgICB3aXRoaW4gPSB0cnVlO1xuICAgICAgICBmb3IgKGkgPSBfaSA9IDA7IDAgPD0gbGVuID8gX2kgPD0gbGVuIDogX2kgPj0gbGVuOyBpID0gMCA8PSBsZW4gPyArK19pIDogLS1faSkge1xuICAgICAgICAgIGlmICh0aGlzLmZyb20uc3RlcHNbaV0gIT09IHRoaXMucGF0aC5zdGVwc1tpXSkge1xuICAgICAgICAgICAgd2l0aGluID0gZmFsc2U7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHdpdGhpbikge1xuICAgICAgICAgIGlmICh0aGlzLnBhdGguc3RlcHMubGVuZ3RoICE9PSBsZW4pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkUGF0Y2hFcnJvcihcIid0bycgbWVtYmVyIGNhbm5vdCBiZSBhIGRlc2NlbmRlbnQgb2YgJ3BhdGgnXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodGhpcy5mcm9tLmFjY2Vzc29yID09PSB0aGlzLnBhdGguYWNjZXNzb3IpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFwcGx5ID0gZnVuY3Rpb24oZG9jdW1lbnQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIE1vdmVQYXRjaC5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbihwYXRjaCkge1xuICAgICAgICBpZiAoISgnZnJvbScgaW4gcGF0Y2gpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRQYXRjaEVycm9yKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIE1vdmVQYXRjaC5wcm90b3R5cGUuYXBwbHkgPSBmdW5jdGlvbihkb2N1bWVudCkge1xuICAgICAgICB2YXIgYWNjZXNzb3IsIHJlZmVyZW5jZSwgdmFsdWU7XG5cbiAgICAgICAgcmVmZXJlbmNlID0gdGhpcy5mcm9tLmdldFJlZmVyZW5jZShkb2N1bWVudCk7XG4gICAgICAgIGFjY2Vzc29yID0gdGhpcy5mcm9tLmFjY2Vzc29yO1xuICAgICAgICBpZiAoaXNBcnJheShyZWZlcmVuY2UpKSB7XG4gICAgICAgICAgYWNjZXNzb3IgPSB0aGlzLmZyb20uY29lcmNlKHJlZmVyZW5jZSwgYWNjZXNzb3IpO1xuICAgICAgICAgIGlmICghKGFjY2Vzc29yIGluIHJlZmVyZW5jZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBQYXRjaENvbmZsaWN0RXJyb3IoXCJWYWx1ZSBhdCBcIiArIGFjY2Vzc29yICsgXCIgZG9lcyBub3QgZXhpc3RcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhbHVlID0gcmVmZXJlbmNlLnNwbGljZShhY2Nlc3NvciwgMSlbMF07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKCEoYWNjZXNzb3IgaW4gcmVmZXJlbmNlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFBhdGNoQ29uZmxpY3RFcnJvcihcIlZhbHVlIGF0IFwiICsgYWNjZXNzb3IgKyBcIiBkb2VzIG5vdCBleGlzdFwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFsdWUgPSByZWZlcmVuY2VbYWNjZXNzb3JdO1xuICAgICAgICAgIGRlbGV0ZSByZWZlcmVuY2VbYWNjZXNzb3JdO1xuICAgICAgICB9XG4gICAgICAgIHJlZmVyZW5jZSA9IHRoaXMucGF0aC5nZXRSZWZlcmVuY2UoZG9jdW1lbnQpO1xuICAgICAgICBhY2Nlc3NvciA9IHRoaXMucGF0aC5hY2Nlc3NvcjtcbiAgICAgICAgaWYgKGlzQXJyYXkocmVmZXJlbmNlKSkge1xuICAgICAgICAgIGFjY2Vzc29yID0gdGhpcy5wYXRoLmNvZXJjZShyZWZlcmVuY2UsIGFjY2Vzc29yKTtcbiAgICAgICAgICBpZiAoYWNjZXNzb3IgPCAwIHx8IGFjY2Vzc29yID4gcmVmZXJlbmNlLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFBhdGNoQ29uZmxpY3RFcnJvcihcIkluZGV4IFwiICsgYWNjZXNzb3IgKyBcIiBvdXQgb2YgYm91bmRzXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZWZlcmVuY2Uuc3BsaWNlKGFjY2Vzc29yLCAwLCB2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGFjY2Vzc29yIGluIHJlZmVyZW5jZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFBhdGNoQ29uZmxpY3RFcnJvcihcIlZhbHVlIGF0IFwiICsgYWNjZXNzb3IgKyBcIiBleGlzdHNcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJlZmVyZW5jZVthY2Nlc3Nvcl0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZG9jdW1lbnQ7XG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gTW92ZVBhdGNoO1xuXG4gICAgfSkoSlNPTlBhdGNoKTtcbiAgICBDb3B5UGF0Y2ggPSAoZnVuY3Rpb24oX3N1cGVyKSB7XG4gICAgICBfX2V4dGVuZHMoQ29weVBhdGNoLCBfc3VwZXIpO1xuXG4gICAgICBmdW5jdGlvbiBDb3B5UGF0Y2goKSB7XG4gICAgICAgIF9yZWY1ID0gQ29weVBhdGNoLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICByZXR1cm4gX3JlZjU7XG4gICAgICB9XG5cbiAgICAgIENvcHlQYXRjaC5wcm90b3R5cGUuYXBwbHkgPSBmdW5jdGlvbihkb2N1bWVudCkge1xuICAgICAgICB2YXIgYWNjZXNzb3IsIHJlZmVyZW5jZSwgdmFsdWU7XG5cbiAgICAgICAgcmVmZXJlbmNlID0gdGhpcy5mcm9tLmdldFJlZmVyZW5jZShkb2N1bWVudCk7XG4gICAgICAgIGFjY2Vzc29yID0gdGhpcy5mcm9tLmFjY2Vzc29yO1xuICAgICAgICBpZiAoaXNBcnJheShyZWZlcmVuY2UpKSB7XG4gICAgICAgICAgYWNjZXNzb3IgPSB0aGlzLmZyb20uY29lcmNlKHJlZmVyZW5jZSwgYWNjZXNzb3IpO1xuICAgICAgICAgIGlmICghKGFjY2Vzc29yIGluIHJlZmVyZW5jZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBQYXRjaENvbmZsaWN0RXJyb3IoXCJWYWx1ZSBhdCBcIiArIGFjY2Vzc29yICsgXCIgZG9lcyBub3QgZXhpc3RcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhbHVlID0gcmVmZXJlbmNlLnNsaWNlKGFjY2Vzc29yLCBhY2Nlc3NvciArIDEpWzBdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICghKGFjY2Vzc29yIGluIHJlZmVyZW5jZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBQYXRjaENvbmZsaWN0RXJyb3IoXCJWYWx1ZSBhdCBcIiArIGFjY2Vzc29yICsgXCIgZG9lcyBub3QgZXhpc3RcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhbHVlID0gcmVmZXJlbmNlW2FjY2Vzc29yXTtcbiAgICAgICAgfVxuICAgICAgICByZWZlcmVuY2UgPSB0aGlzLnBhdGguZ2V0UmVmZXJlbmNlKGRvY3VtZW50KTtcbiAgICAgICAgYWNjZXNzb3IgPSB0aGlzLnBhdGguYWNjZXNzb3I7XG4gICAgICAgIGlmIChpc0FycmF5KHJlZmVyZW5jZSkpIHtcbiAgICAgICAgICBhY2Nlc3NvciA9IHRoaXMucGF0aC5jb2VyY2UocmVmZXJlbmNlLCBhY2Nlc3Nvcik7XG4gICAgICAgICAgaWYgKGFjY2Vzc29yIDwgMCB8fCBhY2Nlc3NvciA+IHJlZmVyZW5jZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBQYXRjaENvbmZsaWN0RXJyb3IoXCJJbmRleCBcIiArIGFjY2Vzc29yICsgXCIgb3V0IG9mIGJvdW5kc1wiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmVmZXJlbmNlLnNwbGljZShhY2Nlc3NvciwgMCwgdmFsdWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChhY2Nlc3NvciBpbiByZWZlcmVuY2UpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBQYXRjaENvbmZsaWN0RXJyb3IoXCJWYWx1ZSBhdCBcIiArIGFjY2Vzc29yICsgXCIgZXhpc3RzXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZWZlcmVuY2VbYWNjZXNzb3JdID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRvY3VtZW50O1xuICAgICAgfTtcblxuICAgICAgcmV0dXJuIENvcHlQYXRjaDtcblxuICAgIH0pKE1vdmVQYXRjaCk7XG4gICAgb3BlcmF0aW9uTWFwID0ge1xuICAgICAgYWRkOiBBZGRQYXRjaCxcbiAgICAgIHJlbW92ZTogUmVtb3ZlUGF0Y2gsXG4gICAgICByZXBsYWNlOiBSZXBsYWNlUGF0Y2gsXG4gICAgICBtb3ZlOiBNb3ZlUGF0Y2gsXG4gICAgICBjb3B5OiBDb3B5UGF0Y2gsXG4gICAgICB0ZXN0OiBUZXN0UGF0Y2hcbiAgICB9O1xuICAgIGNvbXBpbGUgPSBmdW5jdGlvbihwYXRjaCkge1xuICAgICAgdmFyIGtsYXNzLCBvcHMsIHAsIF9pLCBfbGVuO1xuXG4gICAgICBvcHMgPSBbXTtcbiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gcGF0Y2gubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcbiAgICAgICAgcCA9IHBhdGNoW19pXTtcbiAgICAgICAgaWYgKCEoa2xhc3MgPSBvcGVyYXRpb25NYXBbcC5vcF0pKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRQYXRjaEVycm9yKCk7XG4gICAgICAgIH1cbiAgICAgICAgb3BzLnB1c2gobmV3IGtsYXNzKHApKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmdW5jdGlvbihkb2N1bWVudCkge1xuICAgICAgICB2YXIgb3AsIHJlc3VsdCwgX2osIF9sZW4xO1xuXG4gICAgICAgIHJlc3VsdCA9IGRvY3VtZW50O1xuICAgICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBvcHMubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7XG4gICAgICAgICAgb3AgPSBvcHNbX2pdO1xuICAgICAgICAgIHJlc3VsdCA9IG9wLmFwcGx5KGRvY3VtZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfTtcbiAgICB9O1xuICAgIGFwcGx5ID0gZnVuY3Rpb24oZG9jdW1lbnQsIHBhdGNoKSB7XG4gICAgICByZXR1cm4gY29tcGlsZShwYXRjaCkoZG9jdW1lbnQpO1xuICAgIH07XG4gICAgcm9vdC5hcHBseSA9IGFwcGx5O1xuICAgIHJvb3QuY29tcGlsZSA9IGNvbXBpbGU7XG4gICAgcm9vdC5KU09OUG9pbnRlciA9IEpTT05Qb2ludGVyO1xuICAgIHJvb3QuSlNPTlBhdGNoID0gSlNPTlBhdGNoO1xuICAgIHJvb3QuSlNPTlBhdGNoRXJyb3IgPSBKU09OUGF0Y2hFcnJvcjtcbiAgICByb290LkludmFsaWRQb2ludGVyRXJyb3IgPSBJbnZhbGlkUG9pbnRlckVycm9yO1xuICAgIHJvb3QuSW52YWxpZFBhdGNoRXJyb3IgPSBJbnZhbGlkUGF0Y2hFcnJvcjtcbiAgICByb290LlBhdGNoQ29uZmxpY3RFcnJvciA9IFBhdGNoQ29uZmxpY3RFcnJvcjtcbiAgICByZXR1cm4gcm9vdDtcbiAgfSk7XG5cbn0pLmNhbGwodGhpcyk7XG4iXX0=
;